name: nginx

# Replica count for default deployment
replicas: 1

# Max surge for default deployment
maxSurge: 1

# Max unavailable for default deployment
maxUnavailable: 1

deployment:
  enabled: true
  # Default deployment annotations
  annotations:
    prometheus.io/scrape: "true"
    prometheus.io/path: "/_metrics"

PodDisruptionBudget:
  enabled: true
  maxUnavailable: 1

HorizontalPodAutoscaler:
  enabled: true
  minReplicas: 1
  maxReplicas: 3
  averageUtilization: 70

# Image for default deployment
image:
  name: harbor.k8s-sandbox.org/updater-test/nginx
  tag: latest
  # Image pull policy, permitted values: Always | IfNotPresent
  pullPolicy: IfNotPresent

terminationGracePeriodSeconds: 30

securityContext:
  # runAsUser: 101
  # runAsGroup: 101
  # fsGroup: 101
  readOnlyRootFilesystem: false

serviceAccount:
  name: default

# Not uses need implement

# podAnnotations: {}

# podLabels: {}

# nodeSelector: {}

# tolerations: []

# affinity: {}

resources:
  limits:
    cpu: 100m
    memory: 56Mi
  requests:
    cpu: 100m
    memory: 56Mi
startupProbe:
  httpGet:
    path: /
    port: 80
  failureThreshold: 2
  periodSeconds: 5
readinessProbe:
  httpGet:
    path: /healthz
    port: 8080
  failureThreshold: 2
  periodSeconds: 5
livenessProbe:
  httpGet:
    path: /
    port: 80
  failureThreshold: 2
  periodSeconds: 5

service:
  # Whether service is enabled or disabled
  enabled: true
  # Type of service, generally don't need to change
  type:
    ClusterIP
    # Service specific annotations
  annotations:
    lido.fi/maintainer: Full name test
    prometheus.io/probe: "true"
    prometheus.io/path: /_livenessProbe
  ports:
    - name: nginx-http
      port: 8080
      targetPort: 8080
    - name: caddy-http
      port: 8088
      targetPort: 80

pvc:
  enabled: true
        
pvcs:
  - name: app-data
    accessModes:
      - ReadWriteOnce
    size: 1Gi
    storageClass: "longhorn"

  - name: app-cache
    accessModes:
      - ReadWriteOnce
    size: 2Gi
    storageClass: "longhorn"

volumes:
  - name: app-data
    persistentVolumeClaim:
      claimName: app-data

  - name: app-cache
    persistentVolumeClaim:
      claimName: app-cache

# Ingress configuration enable if you need to expose the service to the outside world
ingress:
  enabled: true
  ingressClassName: nginx-internal
  rules:
    - host: hello-1.ramiz.k8s-sandbox.org
      paths:
        - path: /
          pathType: Prefix
  tls:
    - hosts:
        - hello-1.ramiz.k8s-sandbox.org

containers:
  - name: caddy
    image:
      name: docker.io/caddy
      tag: latest
    imagePullPolicy: Always
    resources:
      requests:
        cpu: "150m"
        memory: "128Mi"
    startupProbe:
      httpGet:
        path: /
        port: 80
      failureThreshold: 2
      periodSeconds: 5
    readinessProbe:
      httpGet:
        path: /
        port: 80
      failureThreshold: 2
      periodSeconds: 5
    livenessProbe:
      httpGet:
        path: /
        port: 80
    volumeMounts:
      - name: app-data
        mountPath: /storage/data

  - name: nginx
    image:
      name: harbor.k8s-sandbox.org/updater-test/nginx
      tag: dev
    imagePullPolicy: Always
    resources:
      requests:
        cpu: "130m"
        memory: "100Mi"
    startupProbe:
      httpGet:
        path: /
        port: 8080
      failureThreshold: 2
      periodSeconds: 5
    readinessProbe:
      httpGet:
        path: /
        port: 8080
      failureThreshold: 2
      periodSeconds: 5
    livenessProbe:
      httpGet:
        path: /
        port: 8080
          #    volumeMounts:
          #      - name: app-cache
          #        mountPath: /storage/cache
